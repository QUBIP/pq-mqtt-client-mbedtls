#ifndef SPX_PARAMS_H
#define SPX_PARAMS_H

/* For clarity */
#define SPX_ADDR_BYTES 32

/* WOTS parameters. */
#define SPX_WOTS_LOGW 4

#define SPX_WOTS_LEN2 3

// ----- SHAKE 128 F ----- //
#define SPX_N_SHAKE_128_F           16
#define SPX_FULL_HEIGHT_SHAKE_128_F 66
#define SPX_D_SHAKE_128_F           22
#define SPX_FORS_HEIGHT_SHAKE_128_F 6
#define SPX_FORS_TREES_SHAKE_128_F  33
#define SPX_WOTS_W_SHAKE_128_F      16

#define SPX_WOTS_LEN1_SHAKE_128_F       (8 * SPX_N_SHAKE_128_F / SPX_WOTS_LOGW)
#define SPX_WOTS_LEN_SHAKE_128_F        (SPX_WOTS_LEN1_SHAKE_128_F + SPX_WOTS_LEN2)
#define SPX_WOTS_BYTES_SHAKE_128_F      (SPX_WOTS_LEN_SHAKE_128_F * SPX_N_SHAKE_128_F)
#define SPX_WOTS_PK_BYTES_SHAKE_128_F   SPX_WOTS_BYTES_SHAKE_128_F

#define SPX_TREE_HEIGHT_SHAKE_128_F     (SPX_FULL_HEIGHT_SHAKE_128_F / SPX_D_SHAKE_128_F)

#define SPX_FORS_MSG_BYTES_SHAKE_128_F  ((SPX_FORS_HEIGHT_SHAKE_128_F * SPX_FORS_TREES_SHAKE_128_F + 7) / 8) // + h-h'/8 + h'/8 ?
#define SPX_FORS_BYTES_SHAKE_128_F      ((SPX_FORS_HEIGHT_SHAKE_128_F + 1) * SPX_FORS_TREES_SHAKE_128_F * SPX_N_SHAKE_128_F)
#define SPX_FORS_PK_BYTES_SHAKE_128_F   SPX_N_SHAKE_128_F

#define SPX_BYTES_SHAKE_128_F           (SPX_N_SHAKE_128_F + SPX_FORS_BYTES_SHAKE_128_F + SPX_D_SHAKE_128_F * SPX_WOTS_BYTES_SHAKE_128_F + SPX_FULL_HEIGHT_SHAKE_128_F * SPX_N_SHAKE_128_F)
#define SPX_PK_BYTES_SHAKE_128_F        (2 * SPX_N_SHAKE_128_F)
#define SPX_SK_BYTES_SHAKE_128_F        (2 * SPX_N_SHAKE_128_F + SPX_PK_BYTES_SHAKE_128_F)

// ----- SHAKE 128 S ----- //
#define SPX_N_SHAKE_128_S           16
#define SPX_FULL_HEIGHT_SHAKE_128_S 63
#define SPX_D_SHAKE_128_S           7
#define SPX_FORS_HEIGHT_SHAKE_128_S 12
#define SPX_FORS_TREES_SHAKE_128_S  14
#define SPX_WOTS_W_SHAKE_128_S      16

#define SPX_WOTS_LEN1_SHAKE_128_S       (8 * SPX_N_SHAKE_128_S / SPX_WOTS_LOGW)
#define SPX_WOTS_LEN_SHAKE_128_S        (SPX_WOTS_LEN1_SHAKE_128_S + SPX_WOTS_LEN2)
#define SPX_WOTS_BYTES_SHAKE_128_S      (SPX_WOTS_LEN_SHAKE_128_S * SPX_N_SHAKE_128_S)
#define SPX_WOTS_PK_BYTES_SHAKE_128_S   SPX_WOTS_BYTES_SHAKE_128_S

#define SPX_TREE_HEIGHT_SHAKE_128_S     (SPX_FULL_HEIGHT_SHAKE_128_S / SPX_D_SHAKE_128_S)

#define SPX_FORS_MSG_BYTES_SHAKE_128_S  ((SPX_FORS_HEIGHT_SHAKE_128_S * SPX_FORS_TREES_SHAKE_128_S + 7) / 8) // + h-h'/8 + h'/8 ?
#define SPX_FORS_BYTES_SHAKE_128_S      ((SPX_FORS_HEIGHT_SHAKE_128_S + 1) * SPX_FORS_TREES_SHAKE_128_S * SPX_N_SHAKE_128_S)
#define SPX_FORS_PK_BYTES_SHAKE_128_S   SPX_N_SHAKE_128_S

#define SPX_BYTES_SHAKE_128_S           (SPX_N_SHAKE_128_S + SPX_FORS_BYTES_SHAKE_128_S + SPX_D_SHAKE_128_S * SPX_WOTS_BYTES_SHAKE_128_S + SPX_FULL_HEIGHT_SHAKE_128_S * SPX_N_SHAKE_128_S)
#define SPX_PK_BYTES_SHAKE_128_S        (2 * SPX_N_SHAKE_128_S)
#define SPX_SK_BYTES_SHAKE_128_S        (2 * SPX_N_SHAKE_128_S + SPX_PK_BYTES_SHAKE_128_S)

// ----- SHAKE 192 F ----- //
#define SPX_N_SHAKE_192_F           24
#define SPX_FULL_HEIGHT_SHAKE_192_F 66
#define SPX_D_SHAKE_192_F           22
#define SPX_FORS_HEIGHT_SHAKE_192_F 8
#define SPX_FORS_TREES_SHAKE_192_F  33
#define SPX_WOTS_W_SHAKE_192_F      16

#define SPX_WOTS_LEN1_SHAKE_192_F       (8 * SPX_N_SHAKE_192_F / SPX_WOTS_LOGW)
#define SPX_WOTS_LEN_SHAKE_192_F        (SPX_WOTS_LEN1_SHAKE_192_F + SPX_WOTS_LEN2)
#define SPX_WOTS_BYTES_SHAKE_192_F      (SPX_WOTS_LEN_SHAKE_192_F * SPX_N_SHAKE_192_F)
#define SPX_WOTS_PK_BYTES_SHAKE_192_F   SPX_WOTS_BYTES_SHAKE_192_F

#define SPX_TREE_HEIGHT_SHAKE_192_F     (SPX_FULL_HEIGHT_SHAKE_192_F / SPX_D_SHAKE_192_F)

#define SPX_FORS_MSG_BYTES_SHAKE_192_F  ((SPX_FORS_HEIGHT_SHAKE_192_F * SPX_FORS_TREES_SHAKE_192_F + 7) / 8) // + h-h'/8 + h'/8 ?
#define SPX_FORS_BYTES_SHAKE_192_F      ((SPX_FORS_HEIGHT_SHAKE_192_F + 1) * SPX_FORS_TREES_SHAKE_192_F * SPX_N_SHAKE_192_F)
#define SPX_FORS_PK_BYTES_SHAKE_192_F   SPX_N_SHAKE_192_F

#define SPX_BYTES_SHAKE_192_F           (SPX_N_SHAKE_192_F + SPX_FORS_BYTES_SHAKE_192_F + SPX_D_SHAKE_192_F * SPX_WOTS_BYTES_SHAKE_192_F + SPX_FULL_HEIGHT_SHAKE_192_F * SPX_N_SHAKE_192_F)
#define SPX_PK_BYTES_SHAKE_192_F        (2 * SPX_N_SHAKE_192_F)
#define SPX_SK_BYTES_SHAKE_192_F        (2 * SPX_N_SHAKE_192_F + SPX_PK_BYTES_SHAKE_192_F)

// ----- SHAKE 192 S ----- //
#define SPX_N_SHAKE_192_S           24
#define SPX_FULL_HEIGHT_SHAKE_192_S 63
#define SPX_D_SHAKE_192_S           7
#define SPX_FORS_HEIGHT_SHAKE_192_S 14
#define SPX_FORS_TREES_SHAKE_192_S  17
#define SPX_WOTS_W_SHAKE_192_S      16

#define SPX_WOTS_LEN1_SHAKE_192_S       (8 * SPX_N_SHAKE_192_S / SPX_WOTS_LOGW)
#define SPX_WOTS_LEN_SHAKE_192_S        (SPX_WOTS_LEN1_SHAKE_192_S + SPX_WOTS_LEN2)
#define SPX_WOTS_BYTES_SHAKE_192_S      (SPX_WOTS_LEN_SHAKE_192_S * SPX_N_SHAKE_192_S)
#define SPX_WOTS_PK_BYTES_SHAKE_192_S   SPX_WOTS_BYTES_SHAKE_192_S

#define SPX_TREE_HEIGHT_SHAKE_192_S     (SPX_FULL_HEIGHT_SHAKE_192_S / SPX_D_SHAKE_192_S)

#define SPX_FORS_MSG_BYTES_SHAKE_192_S  ((SPX_FORS_HEIGHT_SHAKE_192_S * SPX_FORS_TREES_SHAKE_192_S + 7) / 8) // + h-h'/8 + h'/8 ?
#define SPX_FORS_BYTES_SHAKE_192_S      ((SPX_FORS_HEIGHT_SHAKE_192_S + 1) * SPX_FORS_TREES_SHAKE_192_S * SPX_N_SHAKE_192_S)
#define SPX_FORS_PK_BYTES_SHAKE_192_S   SPX_N_SHAKE_192_S

#define SPX_BYTES_SHAKE_192_S           (SPX_N_SHAKE_192_S + SPX_FORS_BYTES_SHAKE_192_S + SPX_D_SHAKE_192_S * SPX_WOTS_BYTES_SHAKE_192_S + SPX_FULL_HEIGHT_SHAKE_192_S * SPX_N_SHAKE_192_S)
#define SPX_PK_BYTES_SHAKE_192_S        (2 * SPX_N_SHAKE_192_S)
#define SPX_SK_BYTES_SHAKE_192_S        (2 * SPX_N_SHAKE_192_S + SPX_PK_BYTES_SHAKE_192_S)

// ----- SHAKE 256 F ----- //
#define SPX_N_SHAKE_256_F           32
#define SPX_FULL_HEIGHT_SHAKE_256_F 68
#define SPX_D_SHAKE_256_F           17
#define SPX_FORS_HEIGHT_SHAKE_256_F 9
#define SPX_FORS_TREES_SHAKE_256_F  35
#define SPX_WOTS_W_SHAKE_256_F      16

#define SPX_WOTS_LEN1_SHAKE_256_F       (8 * SPX_N_SHAKE_256_F / SPX_WOTS_LOGW)
#define SPX_WOTS_LEN_SHAKE_256_F        (SPX_WOTS_LEN1_SHAKE_256_F + SPX_WOTS_LEN2)
#define SPX_WOTS_BYTES_SHAKE_256_F      (SPX_WOTS_LEN_SHAKE_256_F * SPX_N_SHAKE_256_F)
#define SPX_WOTS_PK_BYTES_SHAKE_256_F   SPX_WOTS_BYTES_SHAKE_256_F

#define SPX_TREE_HEIGHT_SHAKE_256_F     (SPX_FULL_HEIGHT_SHAKE_256_F / SPX_D_SHAKE_256_F)

#define SPX_FORS_MSG_BYTES_SHAKE_256_F  ((SPX_FORS_HEIGHT_SHAKE_256_F * SPX_FORS_TREES_SHAKE_256_F + 7) / 8) // + h-h'/8 + h'/8 ?
#define SPX_FORS_BYTES_SHAKE_256_F      ((SPX_FORS_HEIGHT_SHAKE_256_F + 1) * SPX_FORS_TREES_SHAKE_256_F * SPX_N_SHAKE_256_F)
#define SPX_FORS_PK_BYTES_SHAKE_256_F   SPX_N_SHAKE_256_F

#define SPX_BYTES_SHAKE_256_F           (SPX_N_SHAKE_256_F + SPX_FORS_BYTES_SHAKE_256_F + SPX_D_SHAKE_256_F * SPX_WOTS_BYTES_SHAKE_256_F + SPX_FULL_HEIGHT_SHAKE_256_F * SPX_N_SHAKE_256_F)
#define SPX_PK_BYTES_SHAKE_256_F        (2 * SPX_N_SHAKE_256_F)
#define SPX_SK_BYTES_SHAKE_256_F        (2 * SPX_N_SHAKE_256_F + SPX_PK_BYTES_SHAKE_256_F)

// ----- SHAKE 256 S ----- //
#define SPX_N_SHAKE_256_S           32
#define SPX_FULL_HEIGHT_SHAKE_256_S 64
#define SPX_D_SHAKE_256_S           8
#define SPX_FORS_HEIGHT_SHAKE_256_S 14
#define SPX_FORS_TREES_SHAKE_256_S  22
#define SPX_WOTS_W_SHAKE_256_S      16

#define SPX_WOTS_LEN1_SHAKE_256_S       (8 * SPX_N_SHAKE_256_S / SPX_WOTS_LOGW)
#define SPX_WOTS_LEN_SHAKE_256_S        (SPX_WOTS_LEN1_SHAKE_256_S + SPX_WOTS_LEN2)
#define SPX_WOTS_BYTES_SHAKE_256_S      (SPX_WOTS_LEN_SHAKE_256_S * SPX_N_SHAKE_256_S)
#define SPX_WOTS_PK_BYTES_SHAKE_256_S   SPX_WOTS_BYTES_SHAKE_256_S

#define SPX_TREE_HEIGHT_SHAKE_256_S     (SPX_FULL_HEIGHT_SHAKE_256_S / SPX_D_SHAKE_256_S)

#define SPX_FORS_MSG_BYTES_SHAKE_256_S  ((SPX_FORS_HEIGHT_SHAKE_256_S * SPX_FORS_TREES_SHAKE_256_S + 7) / 8) // + h-h'/8 + h'/8 ?
#define SPX_FORS_BYTES_SHAKE_256_S      ((SPX_FORS_HEIGHT_SHAKE_256_S + 1) * SPX_FORS_TREES_SHAKE_256_S * SPX_N_SHAKE_256_S)
#define SPX_FORS_PK_BYTES_SHAKE_256_S   SPX_N_SHAKE_256_S

#define SPX_BYTES_SHAKE_256_S           (SPX_N_SHAKE_256_S + SPX_FORS_BYTES_SHAKE_256_S + SPX_D_SHAKE_256_S * SPX_WOTS_BYTES_SHAKE_256_S + SPX_FULL_HEIGHT_SHAKE_256_S * SPX_N_SHAKE_256_S)
#define SPX_PK_BYTES_SHAKE_256_S        (2 * SPX_N_SHAKE_256_S)
#define SPX_SK_BYTES_SHAKE_256_S        (2 * SPX_N_SHAKE_256_S + SPX_PK_BYTES_SHAKE_256_S)


#include "shake_offsets.h"

#endif
